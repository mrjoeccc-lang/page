<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ì—°ì•  ì‹¤íŒ¨ íŒ¨í„´ í…ŒìŠ¤íŠ¸</title>

<link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet">

<style>
:root{
  --bg1:#fff0f6; --bg2:#fff6f9;
  --accent:#ff4d8a; --accent2:#ff8fb7;
  --muted:#6b586b;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:'Gowun Dodum',sans-serif;
  background: linear-gradient(180deg,var(--bg1),var(--bg2));
  display:flex;align-items:center;justify-content:center;padding:28px;
  color:#3b213b;
}

/* Loader */
#loader{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;
  background:linear-gradient(180deg, #ffdfee88, #fff);z-index:999;
}
#loader i{font-size:56px;color:var(--accent);animation:pop 1.2s infinite}
@keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.15)}100%{transform:scale(1)}}

/* Container */
.wrap{
  width:100%;max-width:720px;background:linear-gradient(180deg,rgba(255,255,255,0.9),#fff);
  border-radius:20px;padding:20px 22px 28px;box-shadow:0 14px 40px rgba(255,110,170,0.12);
  position:relative;overflow:hidden;
}

/* floating hearts */
.float{
  position:absolute;width:26px;height:26px;border-radius:6px;background:var(--accent);opacity:.12;
  bottom:-40px;left:10%;animation:up 8s linear infinite;
}
.float:nth-child(2){left:30%;animation-duration:7s;opacity:.14}
.float:nth-child(3){left:55%;animation-duration:9s}
.float:nth-child(4){left:75%;animation-duration:6.5s;opacity:.16}
@keyframes up{0%{transform:translateY(0) rotate(0deg)}100%{transform:translateY(-900px) rotate(180deg);opacity:0}}

.header{display:flex;align-items:center;gap:14px}
.logo{width:62px;height:62px;border-radius:14px;background:linear-gradient(180deg,#fff,#ffeef8);display:flex;align-items:center;justify-content:center;font-size:30px;color:var(--accent);box-shadow:0 8px 24px rgba(255,111,181,0.09)}
.title{font-size:28px;color:var(--accent);margin:0}
.lead{margin:6px 0 14px;color:var(--muted)}

/* card */
.card{background:#fff;border-radius:14px;padding:16px;margin-top:12px;box-shadow:0 8px 20px rgba(219,155,200,0.04);border:1px solid rgba(255,200,230,0.4)}

/* question */
.q-top{display:flex;justify-content:space-between;align-items:center}
.q-num{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;padding:6px 10px;border-radius:999px;font-weight:800}
.q-text{margin:12px 0 8px;font-size:18px;font-weight:800;color:#ab3a6a}

/* options */
.options{display:grid;gap:10px}
.opt{display:flex;gap:12px;align-items:center;padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffaf7);cursor:pointer;border:1px solid rgba(255,150,200,0.14);transition:transform .12s,box-shadow .12s}
.opt:hover{transform:translateY(-4px);box-shadow:0 10px 24px rgba(255,111,181,0.06)}
.opt .ico{width:46px;height:46;border-radius:10px;background:linear-gradient(180deg,#fff1f8,#ffdff0);display:flex;align-items:center;justify-content:center;font-weight:900;color:var(--accent);}

/* footer */
.footer{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-top:14px}
.progress{flex:1;height:10px;background:#ffeef6;border-radius:999px;overflow:hidden;border:1px solid rgba(255,200,230,0.6)}
.bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .28s}
.btn{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;padding:10px 14px;border-radius:12px;border:0;font-weight:800;cursor:pointer}

/* result */
.result-wrap{text-align:center;padding:10px}
.result-emoji{font-size:56px;margin-top:6px}
.result-title{font-size:22px;font-weight:900;color:var(--accent);margin:8px 0}
.result-desc{color:var(--muted);line-height:1.6;margin:8px 12px}
.share-row{display:flex;gap:10px;justify-content:center;margin-top:12px}
.small{font-size:13px;color:#a07ea6;margin-top:8px}

/* canvas (hidden) */
#resultCanvas{display:none}

/* responsive */
@media (max-width:480px){
  .title{font-size:22px}
  .q-text{font-size:16px}
  .logo{width:50px;height:50px}
}
</style>
</head>
<body>

<div id="loader">
  <i class="ri-heart-pulse-fill"></i>
  <div style="height:8px"></div>
  <div style="color:#8b6a8b">í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë”©ì¤‘...</div>
</div>

<div class="wrap" id="app" style="display:none">
  <div class="float" style="border-radius:40%/60%"></div>
  <div class="float"></div>
  <div class="float"></div>
  <div class="float"></div>

  <div class="header">
    <div class="logo">â¤</div>
    <div>
      <h1 class="title">ì—°ì•  ì‹¤íŒ¨ íŒ¨í„´ í…ŒìŠ¤íŠ¸</h1>
      <div class="lead">ì™œ ë§¤ë²ˆ ì—°ì• ê°€ ëë‚ ê¹Œ? ë‹¹ì‹ ì˜ ì‹¤íŒ¨ íŒ¨í„´ì„ íŒŒí—¤ì¹©ë‹ˆë‹¤.</div>
    </div>
  </div>

  <div class="card" id="introCard">
    <h3 style="margin:0">í…ŒìŠ¤íŠ¸ ì•ˆë‚´</h3>
    <p class="small" style="margin-top:8px;color:var(--muted)">10ë¬¸í•­ â€” ê°€ì¥ ë§ì´ ì„ íƒëœ ìœ í˜•ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì‹¤íŒ¨ íŒ¨í„´ì„ ì§„ë‹¨í•©ë‹ˆë‹¤. ê²°ê³¼ëŠ” ê³µìœ  ë° ì´ë¯¸ì§€ ì €ì¥ ê°€ëŠ¥.</p>
    <div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap">
      <button id="startBtn" class="btn">í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
      <button id="howBtn" class="btn" style="background:transparent;color:var(--accent);border:1px dashed rgba(255,111,181,0.12)">ë°©ì‹ ë³´ê¸°</button>
    </div>
  </div>

  <div class="card" id="quizCard" style="display:none">
    <div class="q-top">
      <div class="q-num" id="qNum">Q1</div>
      <div style="color:var(--muted);font-weight:800" id="qProgress">1 / 10</div>
    </div>
    <div class="q-text" id="qText">ì§ˆë¬¸</div>

    <div class="options" id="options"></div>

    <div class="footer">
      <div class="progress"><div class="bar" id="bar"></div></div>
      <div style="min-width:120px;text-align:right">
        <button id="skipBtn" class="btn" style="background:transparent;color:var(--accent);border:1px solid rgba(255,111,181,0.12)">ê±´ë„ˆë›°ê¸°</button>
      </div>
    </div>
  </div>

  <div class="card" id="resultCard" style="display:none">
    <div class="result-wrap">
      <div class="result-emoji" id="resEmoji">ğŸ’¥</div>
      <div class="result-title" id="resTitle">ê²°ê³¼ íƒ€ì´í‹€</div>
      <div class="result-desc" id="resDesc"></div>

      <div style="display:flex;justify-content:center;gap:10px;margin-top:8px;flex-wrap:wrap">
        <button id="copyBtn" class="btn" style="background:linear-gradient(90deg,#ffbcd7,#ff8fb7)">ê²°ê³¼ ë³µì‚¬</button>
        <button id="tweetBtn" class="btn" style="background:linear-gradient(90deg,#8bbdff,#6fb8ff)">Xì— ê³µìœ </button>
        <button id="downloadBtn" class="btn" style="background:linear-gradient(90deg,#ffdb8d,#ffc36b)">ê²°ê³¼ ì´ë¯¸ì§€ ì €ì¥</button>
      </div>

      <div class="small">ìì„¸í•œ í•´ê²° íŒì€ ê²°ê³¼ ì•„ë˜ ë¬¸êµ¬ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</div>
      <div style="text-align:center;margin-top:12px">
        <button id="retryBtn" class="btn" style="background:linear-gradient(90deg,#ff7aa1,#ff4d8a);padding:12px 20px">ë‹¤ì‹œ í…ŒìŠ¤íŠ¸</button>
      </div>
    </div>
  </div>

</div>

<canvas id="resultCanvas" width="800" height="1000"></canvas>

<script>
/* ë°ì´í„° */
const questions = [
{q:"1. ì¸ ë‹¨ê³„ì—ì„œ ë‹¹ì‹ ì€ ì–´ë–¤ ìŠ¤íƒ€ì¼ì¸ê°€?", opts:[
  {t:"A", txt:"ë¨¼ì € ë§ˆìŒ í‘œí˜„ ì˜ ëª»í•¨"},
  {t:"B", txt:"ê³¼í•˜ê²Œ ë¹¨ë¦¬ ì˜¬ì¸í•¨"},
  {t:"C", txt:"ë°€ë‹¹ì´ ì‹¬í•¨"},
  {t:"D", txt:"ê´€ì‹¬ì´ ì‹ëŠ” ì†ë„ê°€ ë¹ ë¦„"}
]},
{q:"2. ìƒëŒ€ê°€ ë©”ì‹œì§€ë¥¼ ëŠ¦ê²Œ ë³´ëƒˆì„ ë•Œ?", opts:[
  {t:"A", txt:"ë¶ˆì•ˆí•´ì„œ ëˆˆì¹˜ ë´„"},
  {t:"B", txt:"ë°”ë¡œ ì„œìš´í•¨ì„ í‘œí˜„í•¨"},
  {t:"C", txt:"ì¼ë¶€ëŸ¬ ë” ëŠ¦ê²Œ ë‹µí•¨"},
  {t:"D", txt:"í¥ë¯¸ê°€ í™• ë–¨ì–´ì§"}
]},
{q:"3. ì—°ì•  ì´ˆë°˜, ë‹¹ì‹ ì˜ í…œí¬ëŠ”?", opts:[
  {t:"A", txt:"ìƒëŒ€ ëˆˆì¹˜ ë§ì´ ë´„"},
  {t:"B", txt:"í­ì£¼ ê¸°ì–´ â€” ë„ˆë¬´ ë¹¨ë¦¬ ì • ë¶™ì„"},
  {t:"C", txt:"ê³„ì‚°ì  â€” ê°ì •ë³´ë‹¤ ë¨¸ë¦¬ êµ´ë¦¼"},
  {t:"D", txt:"ì¢‹ì•„ë„ ì˜¤ë˜ ëª» ê°"}
]},
{q:"4. ê°ˆë“±ì´ ìƒê¸°ë©´?", opts:[
  {t:"A", txt:"íšŒí”¼í•˜ê³  ìˆ¨ìŒ"},
  {t:"B", txt:"ë°”ë¡œ ê°ì •ì ìœ¼ë¡œ í„°ì§"},
  {t:"C", txt:"ì§ˆì§ˆ ëŒë©´ì„œ ë¨¸ë¦¬ ì‹¸ì›€í•¨"},
  {t:"D", txt:"ê·¸ëƒ¥ ë§ˆìŒì´ ì‹ì–´ë²„ë¦¼"}
]},
{q:"5. ì—°ì• ê°€ í¸í•´ì§€ë©´ ë‹¹ì‹ ì€?", opts:[
  {t:"A", txt:"ìƒëŒ€ ë¹„ìœ„ë¥¼ ë§ì¶”ëŠë¼ ì§€ì¹¨"},
  {t:"B", txt:"ì§‘ì°© ê°•í•´ì§"},
  {t:"C", txt:"ë¬´ì‹¬ + ì˜ˆë¯¼ ëª¨ë“œ"},
  {t:"D", txt:"ê¶Œíƒœê°ì´ ë¹¨ë¦¬ ì˜´"}
]},
{q:"6. ìƒëŒ€ê°€ ì„ ì„ ë„˜ì—ˆì„ ë•Œ?", opts:[
  {t:"A", txt:"ëª» ë³¸ ì²™ ì°¸ìŒ"},
  {t:"B", txt:"ë°”ë¡œ í­ë°œí•˜ê³  ì‹¸ì›€ ë‚¨"},
  {t:"C", txt:"ê³„ì‚° í›„ ë˜ê°šìŒ"},
  {t:"D", txt:"ì • ë–¨ì–´ì§"}
]},
{q:"7. í‘œí˜„ ìŠ¤íƒ€ì¼ì€?", opts:[
  {t:"A", txt:"ì¡°ì‹¬ìŠ¤ëŸ¬ì›€"},
  {t:"B", txt:"ì§ì„¤ + ê°ì •ì "},
  {t:"C", txt:"ì€ê·¼í•œ ì „ëµí˜•"},
  {t:"D", txt:"ë‹´ë°±í•¨ â†’ ë¬´ê´€ì‹¬"}
]},
{q:"8. ì´ë³„ í›„ ë‹¹ì‹ ì€?", opts:[
  {t:"A", txt:"ìì±…í•¨"},
  {t:"B", txt:"ê°ì • í­ë°œ í›„ ê¸ˆë°© ìŠìŒ"},
  {t:"C", txt:"ì¬íšŒ ì‹œë‚˜ë¦¬ì˜¤ ì§¬"},
  {t:"D", txt:"ë°”ë¡œ ë‹¤ìŒ ì‚¬ëŒ ì°¾ì•„ê°"}
]},
{q:"9. ìƒëŒ€ê°€ ë…¸ë ¥ ì•ˆ í•  ë•Œ?", opts:[
  {t:"A", txt:"ë‚˜ë¼ë„ ë…¸ë ¥í•¨"},
  {t:"B", txt:"í­ë°œí•¨"},
  {t:"C", txt:"ë°€ë‹¹ ê°•í™”í•¨"},
  {t:"D", txt:"ë§ˆìŒì´ ë°”ë¡œ ë©€ì–´ì§"}
]},
{q:"10. ì—°ì• ê°€ ì˜ ì•ˆ ë˜ëŠ” ì´ìœ ëŠ”?", opts:[
  {t:"A", txt:"ë‚´ê°€ ë„ˆë¬´ ì°©í•´ì„œ"},
  {t:"B", txt:"ë„ˆë¬´ ê°ì •ì ì´ë¼ì„œ"},
  {t:"C", txt:"ë‚´ê°€ ë³µì¡í•´ì„œ"},
  {t:"D", txt:"ê¸ˆë°© ì§ˆë ¤ì„œ"}
]}
];

const results = {
 A:{
  emoji:"ğŸ•Šï¸",
  title:"ê³¼ëª°ì…í˜• ì‹¤íŒ¨ íŒ¨í„´",
  desc:"ë‹¹ì‹ ì€ ê´€ê³„ì— ì‰½ê²Œ ëª°ì…í•˜ì§€ë§Œ, í‘œí˜„ì´ ì†Œê·¹ì ì´ê³  ìƒëŒ€ì—ê²Œ ì§„ì‹¬ì„ ì „í•˜ì§€ ëª»í•´ ê´€ê³„ê°€ íë ¤ì§‘ë‹ˆë‹¤. 'ë„ˆë¬´ ì°©í•´ì„œ' ê´€ê³„ê°€ ë¬´ë„ˆì§€ëŠ” ì•„ì´ëŸ¬ë‹ˆì— ë¹ ì§ˆ ìˆ˜ ìˆì–´ìš”. í•´ê²°ë²•: ì†Œì†Œí•œ ìš”êµ¬ë„ ì†”ì§íˆ ë§í•´ë³´ì„¸ìš” â€” ìƒëŒ€ë„ ëª°ëì„ ë¿ì…ë‹ˆë‹¤."
 },
 B:{
  emoji:"ğŸ”¥",
  title:"ê°ì • í­ë°œí˜• ì‹¤íŒ¨ íŒ¨í„´",
  desc:"ê°ì • ê¸°ë³µì´ í¬ê³  ìˆœê°„ì  ëŒ€ì‘ìœ¼ë¡œ ê´€ê³„ê°€ ë¬´ë„ˆì§€ê³¤ í•©ë‹ˆë‹¤. ì´ˆë°˜ì—ëŠ” ê°•ë ¬í•˜ì§€ë§Œ ê²°êµ­ ê°ì •ì˜ íŒŒê³ ê°€ ê´€ê³„ë¥¼ ê°‰ì•„ë¨¹ìŠµë‹ˆë‹¤. í•´ê²°ë²•: í•œ ë°•ì ì‰¬ê³  ë§í•˜ê¸°, ê·¸ë¦¬ê³  ê°ì • ê¸°ë¡ìœ¼ë¡œ íŒ¨í„´ íŒŒì•…ì„."
 },
 C:{
  emoji:"ğŸ§ ",
  title:"ë°€ë‹¹Â·ì „ëµí˜• ì‹¤íŒ¨ íŒ¨í„´",
  desc:"ì—°ì• ë¥¼ ê²Œì„ ì‚¼ì•„ ì›€ì§ì´ë©´ ìƒëŒ€ëŠ” í”¼ë¡œë¥¼ ëŠë¼ê³  ë– ë‚©ë‹ˆë‹¤. ê³„ì‚°ì  íƒœë„ëŠ” ì¼ì‹œì  ìš°ìœ„ë¥¼ ì£¼ì§€ë§Œ ì¥ê¸°ì  ì‹ ë¢°ë¥¼ ë§ê°€ëœ¨ë ¤ìš”. í•´ê²°ë²•: ì •ì§í•œ í‘œí˜„ ì—°ìŠµê³¼ ì‘ì€ ì•½ì†ë¶€í„° ì§€í‚¤ê¸°."
 },
 D:{
  emoji:"â„ï¸",
  title:"ê¸ˆë°© ì‹ëŠ” ì‹¤íŒ¨ íŒ¨í„´",
  desc:"ê´€ì‹¬ì˜ ì‹œì‘ì€ ë¹ ë¥´ì§€ë§Œ ìœ ì§€ê°€ í˜ë“¤ì–´ ê´€ê³„ê°€ ê¹Šì–´ì§€ê¸° ì „ì— ëë‚˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ìƒëŒ€ëŠ” ë‹¹ì‹ ì„ ë¶ˆì•ˆì •í•˜ê²Œ ëŠë‚„ ìˆ˜ ìˆì–´ìš”. í•´ê²°ë²•: ì‘ì€ ë£¨í‹´ìœ¼ë¡œ ê°ì • ì—°ê²°ì„ ê¾¸ì¤€íˆ ë§Œë“œëŠ” ìŠµê´€ì„ ë“¤ì´ì„¸ìš”."
 }
};

/* ìƒíƒœ */
let state = { index:0, scores:{A:0,B:0,C:0,D:0} };

/* ìš”ì†Œ */
const loader = document.getElementById('loader');
const app = document.getElementById('app');
const startBtn = document.getElementById('startBtn');
const howBtn = document.getElementById('howBtn');
const introCard = document.getElementById('introCard');
const quizCard = document.getElementById('quizCard');
const resultCard = document.getElementById('resultCard');
const qNum = document.getElementById('qNum');
const qText = document.getElementById('qText');
const optionsWrap = document.getElementById('options');
const qProgress = document.getElementById('qProgress');
const bar = document.getElementById('bar');

const resEmoji = document.getElementById('resEmoji');
const resTitle = document.getElementById('resTitle');
const resDesc = document.getElementById('resDesc');
const copyBtn = document.getElementById('copyBtn');
const tweetBtn = document.getElementById('tweetBtn');
const downloadBtn = document.getElementById('downloadBtn');
const retryBtn = document.getElementById('retryBtn');
const skipBtn = document.getElementById('skipBtn');

/* ë¡œë”© í›„ í‘œì‹œ */
setTimeout(()=>{ loader.style.display='none'; app.style.display='block'; },900);

/* ë Œë” í•¨ìˆ˜ */
function renderQuestion(){
  const i = state.index;
  const q = questions[i];
  qNum.textContent = `Q${i+1}`;
  qText.textContent = q.q;
  qProgress.textContent = `${i+1} / ${questions.length}`;
  bar.style.width = `${Math.round((i)/questions.length*100)}%`;
  optionsWrap.innerHTML = '';
  q.opts.forEach((o, idx) => {
    const d = document.createElement('div');
    d.className='opt';
    d.tabIndex = 0;
    d.innerHTML = `<div class="ico">${String.fromCharCode(65+idx)}</div><div style="flex:1">${o.txt}</div>`;
    d.addEventListener('click', ()=> selectOption(o.t));
    d.addEventListener('keydown', e=>{ if(e.key==='Enter' || e.key===' ') selectOption(o.t) });
    optionsWrap.appendChild(d);
  });
}

/* ì„ íƒ */
function selectOption(type){
  if(state.scores[type] !== undefined) state.scores[type]++;
  nextStep();
}

function nextStep(){
  if(state.index < questions.length - 1){
    state.index++;
    renderQuestion();
  } else showResult();
}

startBtn.addEventListener('click', ()=>{
  introCard.style.display='none';
  quizCard.style.display='block';
  state.index=0; state.scores={A:0,B:0,C:0,D:0};
  bar.style.width='0%';
  renderQuestion();
});

howBtn.addEventListener('click', ()=> {
  alert('10ë¬¸í•­ìœ¼ë¡œ ê°€ì¥ ë§ì´ ì„ íƒëœ ìœ í˜•ì„ ê²°ê³¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. ê²°ê³¼ëŠ” ë³µì‚¬/ê³µìœ /ì´ë¯¸ì§€ ì €ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
});

skipBtn.addEventListener('click', ()=> nextStep());

/* ê²°ê³¼ ê³„ì‚° */
function showResult(){
  quizCard.style.display='none';
  // find max
  const entries = Object.entries(state.scores).sort((a,b)=>b[1]-a[1]);
  const topScore = entries[0][1];
  const tied = entries.filter(e=> e[1]===topScore).map(e=>e[0]);
  // priority tie-break
  const prio = ['B','A','C','D'];
  let pick = tied[0];
  for(const p of prio) if(tied.includes(p)){ pick=p; break; }

  const r = results[pick];
  resEmoji.textContent = r.emoji;
  resTitle.textContent = r.title;
  resDesc.textContent = r.desc;

  resultCard.style.display='block';
  // fill progress bar full
  bar.style.width = '100%';
}

/* ë³µì‚¬ */
copyBtn.addEventListener('click', ()=>{
  const text = `${resTitle.textContent}\n${resDesc.textContent}\n(ì—°ì•  ì‹¤íŒ¨ íŒ¨í„´ í…ŒìŠ¤íŠ¸)\n${location.href}`;
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(text).then(()=> alert('ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'));
  } else { prompt('ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”', text); }
});

/* íŠ¸ìœ— ê³µìœ  */
tweetBtn.addEventListener('click', ()=>{
  const txt = encodeURIComponent(`${resTitle.textContent} â€” ${resDesc.textContent.slice(0,80)}... ê²°ê³¼ í™•ì¸ ğŸ‘‰ `);
  const url = encodeURIComponent(location.href);
  window.open(`https://twitter.com/intent/tweet?text=${txt}&url=${url}`, '_blank');
});

/* ì´ë¯¸ì§€ ìƒì„± (Canvas) */
downloadBtn.addEventListener('click', ()=> {
  generateResultImage().then(dataUrl => {
    const a = document.createElement('a');
    a.href = dataUrl; a.download = 'love-failure-result.png';
    document.body.appendChild(a); a.click(); a.remove();
  }).catch(e=>{ alert('ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨'); console.error(e); });
});

async function generateResultImage(){
  const canvas = document.getElementById('resultCanvas');
  const ctx = canvas.getContext('2d');
  // clear
  ctx.fillStyle = '#fff4fb';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // header
  ctx.fillStyle = '#ff4d8a';
  ctx.font = '36px Gowun Dodum, sans-serif';
  ctx.fillText('ì—°ì•  ì‹¤íŒ¨ íŒ¨í„´ í…ŒìŠ¤íŠ¸', 40, 80);

  // emoji big
  ctx.font = '72px serif';
  ctx.fillText(resEmoji.textContent, 360, 170);

  // title
  ctx.fillStyle = '#ab3a6a';
  ctx.font = '32px Gowun Dodum, sans-serif';
  wrapText(ctx, resTitle.textContent, 40, 240, 720, 36);

  // desc
  ctx.fillStyle = '#6b586b';
  ctx.font = '20px Gowun Dodum, sans-serif';
  wrapText(ctx, resDesc.textContent, 40, 320, 720, 28);

  // footer note
  ctx.fillStyle = '#a57fa9';
  ctx.font = '16px Gowun Dodum, sans-serif';
  ctx.fillText('(í…ŒìŠ¤íŠ¸ by ë‹¹ì‹ ì˜ í˜ì´ì§€)', 40, 920);

  return canvas.toDataURL('image/png');
}

// helper: wrap text
function wrapText(ctx, text, x, y, maxWidth, lineHeight){
  const words = text.split(' ');
  let line = '';
  for(let n=0;n<words.length;n++){
    const testLine = line + words[n] + ' ';
    const metrics = ctx.measureText(testLine);
    if(metrics.width > maxWidth && n > 0){
      ctx.fillText(line, x, y);
      line = words[n] + ' ';
      y += lineHeight;
    } else {
      line = testLine;
    }
  }
  ctx.fillText(line, x, y);
}

/* ë‹¤ì‹œí•˜ê¸° */
retryBtn.addEventListener('click', ()=> location.reload());

/* ì´ˆê¸° ë Œë”(ì•ˆì „) */
document.addEventListener('DOMContentLoaded', ()=> {
  // nothing yet
});
</script>
</body>
</html>
